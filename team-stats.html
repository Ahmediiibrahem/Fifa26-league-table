<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Team Stats</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="icon" type="image/jpeg" href="fifa26.jpeg">

<style>

    .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
}

.header-logo {
    height: 100px;   /* عدّل الحجم لو حابب */
    object-fit: contain;
}


    /* تحسين التابات */
nav {
    display: flex;
    justify-content: center; /* توسيط التابات */
    gap: 20px; /* مسافة بين التابات */
    margin-bottom: 20px;
}

nav a {
    text-decoration: none;
    color: #fff; /* لون النص */
    font-weight: 700;
    padding: 10px 25px;
    border-radius: 8px;
    transition: all 0.3s ease;
    background: #2b2b2b; /* خلفية التاب */
}

nav a:hover {
    background: #3498db; /* خلفية عند المرور بالفأرة */
    color: #fff;
    transform: scale(1.05); /* تكبير خفيف عند hover */
}

nav a.active {
    background: #3498db; /* لون التاب النشط */
    color: #fff;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

    
body {
    font-family:'Cairo', Arial, sans-serif;
    color:#fff;
    font-weight:700;

    background:
        linear-gradient(
            rgba(15, 15, 15, 0.85),
            rgba(15, 15, 15, 0.85)
        ),
        url("standings-bg.jpg");

    background-size: cover;
    background-position: center;
    background-attachment: fixed;
}


h2 {
    text-align:center;
    margin-bottom:15px;
    font-family: 'Cairo', Arial, sans-serif; /* خط Cairo */
    font-weight: 800; /* Bold أكثر */

}

table {
    width: 100%;
    border-collapse: collapse;
    font-size:14px;
    font-family: 'Cairo', Arial, sans-serif; /* خط Cairo */
    font-weight: 700; /* Bold */
}

th {
    background:#2b2b2b;
    padding:10px;
    font-weight: 800; /* Bold أكثر لرؤوس الأعمدة */

}

td {
    padding:8px;
    text-align:center;
    font-weight: 700; /* Bold للنصوص داخل الخلايا */
}

tr:nth-child(even) {
    background:#1a1a1a;
}

.rank {
    background:#3a3a3a;
    font-weight:bold;
}

.team {
    text-align:center;
    border-collapse: collapse;
    
}
</style>
</head>

<body>

    <div class="page-header">
    <img src="left-logo.png" alt="Left Logo" class="header-logo left">
    <img src="right-logo.png" alt="Right Logo" class="header-logo right">
</div>


    
    <nav>
  <a href="index.html">Standings</a>
  <a href="matches.html">Results</a>
  <a href="upcoming.html">Upcoming</a>
  <a href="team-stats.html" class="active">Stats</a>
        
</nav>

<h2>Team Statistics</h2>

<div id="teamTabs" class="team-tabs">
    <!-- أسماء الفرق تتحول لتابات هنا -->
</div>

<div class="stats" id="statsDisplay">
    <div class="stats-left"></div>
    <div class="stats-right"></div>
</div>

<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT54W8eLRnu7YjOYR49uv-FWsBL1VZR3JUptdsdaP7gYmVIyrtHEmoOd0ZR0uaAijzMXbAhmweN1_5n/pub?gid=866991516&single=true&output=csv&t=" + Date.now();

function parseCSV(text) {
    return text.trim().split("\n").map(row =>
        row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(col => col.replace(/^"|"$/g, ''))
    );
}

const teamTabs = document.getElementById("teamTabs");
const statsDisplay = document.getElementById("statsDisplay");
let allData = [];

fetch(sheetURL, {cache: "no-store"})
.then(res => res.text())
.then(csv => {
    allData = parseCSV(csv).slice(1); // تجاهل الهيدر

    // جمع أسماء الفرق بدون تكرار وتجاهل أي كلمة خاطئة
    const teams = new Set();
    allData.forEach(match => {
        const home = match[2]?.trim();
        const away = match[11]?.trim();
        if(home && home.toLowerCase() !== "lose") teams.add(home);
        if(away && away.toLowerCase() !== "lose") teams.add(away);
    });

    // إنشاء التابات
    teams.forEach(team => {
        const tab = document.createElement("div");
        tab.textContent = team;
        tab.classList.add("team-tab");
        tab.addEventListener("click", () => showTeamStats(team, tab));
        teamTabs.appendChild(tab);
    });
});

// دالة عرض الإحصائيات + الأهداف + فارق الأهداف + النقاط + اللاعبين
function showTeamStats(team, clickedTab) {
    // تفعيل تاب واحد فقط
    document.querySelectorAll(".team-tab").forEach(t => t.classList.remove("active"));
    clickedTab.classList.add("active");

    let played = 0, won = 0, draw = 0, lost = 0, goalsFor = 0, goalsAgainst = 0;

    allData.forEach(match => {
        const status = match[15]?.trim(); // Match Status
        const homeTeam = match[2];
        const awayTeam = match[11];
        const homeScore = parseInt(match[6]);
        const awayScore = parseInt(match[7]);

        if(status !== "Played") return;

        if(homeTeam === team || awayTeam === team){
            played++;

            if(homeScore === awayScore) draw++;
            else if((homeTeam === team && homeScore > awayScore) || (awayTeam === team && awayScore > homeScore)) won++;
            else lost++;

            if(homeTeam === team){
                goalsFor += homeScore;
                goalsAgainst += awayScore;
            } else {
                goalsFor += awayScore;
                goalsAgainst += homeScore;
            }
        }
    });

    const goalDiff = goalsFor - goalsAgainst;
    const points = won * 3 + draw * 1;

    // اللاعبين (مثال ثابت)
    const players = ["Ahmed Ibrahem", "Abdoulrahman Atef"];

    statsDisplay.innerHTML = `
        <div class="stats-left">
            <div>Played: ${played}</div>
            <div>Won: ${won}</div>
            <div>Draw: ${draw}</div>
            <div>Lost: ${lost}</div>
            <div>Goals For: ${goalsFor}</div>
            <div>Goals Against: ${goalsAgainst}</div>
            <div>Goal Difference: ${goalDiff}</div>
            <div>Points: ${points}</div>
        </div>
        <div class="stats-right">
            <div>Players:</div>
            ${players.map(p => `<div>${p}</div>`).join('')}
        </div>
    `;
}
</script>

</body>
</html>
