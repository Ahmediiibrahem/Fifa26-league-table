<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>League Table</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="icon" type="image/jpeg" href="fifa26.jpeg">

<style>
body {
    font-family:'Cairo', Arial, sans-serif;
    color:#fff;
    font-weight:700;
    background:
        linear-gradient(rgba(15,15,15,0.85), rgba(15,15,15,0.85)),
        url("standings-bg.jpg");
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
}

.page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
}

.logo-box {
    text-align: center;
    cursor: pointer;
}

.header-logo {
    height: 100px;
    object-fit: contain;
}

.player-points {
    margin-top: 5px;
    font-size: 16px;
}

nav {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 20px;
}

nav a {
    text-decoration: none;
    color: #fff;
    font-weight: 700;
    padding: 10px 25px;
    border-radius: 8px;
    background: #2b2b2b;
    transition: 0.3s;
}

nav a:hover,
nav a.active {
    background: #3498db;
}

h2 {
    text-align:center;
    margin-bottom:15px;
    font-weight:800;
}

table {
    width:100%;
    border-collapse: collapse;
    font-size:14px;
}

th {
    background:#2b2b2b;
    padding:10px;
    font-weight:800;
}

td {
    padding:8px;
    text-align:center;
}

tr:nth-child(even) {
    background:#1a1a1a;
}

.rank {
    background:#3a3a3a;
    font-weight:bold;
}

/* TEAM CELL WITH LOGO */
.team-cell {
    display: flex;
    align-items: center;
    gap: 8px;
    justify-content: center;
}

.team-cell img {
    width: 26px;
    height: 26px;
    object-fit: contain;
}

/* FORM */
.form-box {
    display: flex;
    gap: 4px;
    justify-content: center;
}

.form-box div {
    width: 18px;
    height: 18px;
    line-height: 18px;
    font-size: 12px;
    border-radius: 4px;
}

.form-W { background: green; }
.form-L { background: red; }
.form-D { background: gray; }

/* RULES */
.rules-container {
    width: 90%;
    margin: 20px auto;
}

.rules-toggle {
    width: 100%;
    background: #2b2b2b;
    color: #fff;
    padding: 12px;
    font-weight: 700;
    border-radius: 8px;
    cursor: pointer;
    border: none;
}

.rules-content {
    max-height: 0;
    overflow: hidden;
    transition: 0.5s;
    background: #1a1a1a;
    padding: 0 20px;
    border-radius: 8px;
}

.rules-content.open {
    max-height: 400px;
    padding: 15px 20px;
}
</style>
</head>

<body>

<div class="page-header">
    <div class="logo-box" id="leftPlayer">
        <img src="left-logo.png" class="header-logo">
        <div class="player-points" id="left-points">Points: 0</div>
    </div>

    <div class="logo-box" id="rightPlayer">
        <img src="right-logo.png" class="header-logo">
        <div class="player-points" id="right-points">Points: 0</div>
    </div>
</div>

<nav>
    <a class="active" href="index.html">Standings</a>
    <a href="matches.html">Results</a>
    <a href="upcoming.html">Upcoming</a>
    <a href="team-stats.html">Stats</a>
</nav>

<h2>League Table</h2>

<table>
<thead>
<tr>
    <th>#</th>
    <th>Team</th>
    <th>P</th>
    <th>W</th>
    <th>D</th>
    <th>L</th>
    <th>DIFF</th>
    <th>G/S</th>
    <th>G/C</th>
    <th>Points</th>
    <th>Owner</th>
    <th>Form</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

<div class="rules-container">
    <button class="rules-toggle">Rules â–¼</button>
    <div class="rules-content">
        <ol>
            <li>Points</li>
            <li>Goal Difference</li>
            <li>Goals Scored</li>
            <li>Goals Conceded</li>
        </ol>
    </div>
</div>

<script>
const standingsURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT54W8eLRnu7YjOYR49uv-FWsBL1VZR3JUptdsdaP7gYmVIyrtHEmoOd0ZR0uaAijzMXbAhmweN1_5n/pub?gid=1129539507&single=true&output=csv";
const formURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT54W8eLRnu7YjOYR49uv-FWsBL1VZR3JUptdsdaP7gYmVIyrtHEmoOd0ZR0uaAijzMXbAhmweN1_5n/pub?gid=882748508&single=true&output=csv";
const teamsURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT54W8eLRnu7YjOYR49uv-FWsBL1VZR3JUptdsdaP7gYmVIyrtHEmoOd0ZR0uaAijzMXbAhmweN1_5n/pub?gid=TEAMS_GID&single=true&output=csv";

function parseCSV(text) {
    return text.trim().split("\n").map(r =>
        r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c => c.replace(/^"|"$/g,''))
    );
}

let teamLogos = {};
let formHeaders = [];
let formData = [];

fetch(teamsURL).then(r=>r.text()).then(csv=>{
    parseCSV(csv).slice(1).forEach(r=>{
        teamLogos[r[1]] = r[2];
    });
});

fetch(formURL).then(r=>r.text()).then(csv=>{
    const d = parseCSV(csv);
    formHeaders = d[0].slice(1).map(h=>h.toLowerCase());
    formData = d.slice(1).map(r=>r.slice(1));
});

fetch(standingsURL).then(r=>r.text()).then(csv=>{
    const rows = parseCSV(csv).slice(1);
    const tbody = document.getElementById("tableBody");
    let pointsByOwner = {};

    rows.forEach((c,i)=>{
        const owner = c[11];
        pointsByOwner[owner]=(pointsByOwner[owner]||0)+(+c[10]);

        let idx=formHeaders.indexOf(c[2].toLowerCase());
        let formHTML='<div class="form-box">';
        if(idx>-1){
            formData.forEach(r=>{
                let v=r[idx].toLowerCase();
                formHTML+=`<div class="form-${v[0].toUpperCase()}">${v[0].toUpperCase()}</div>`;
            });
        }
        formHTML+='</div>';

        tbody.innerHTML+=`
        <tr>
            <td class="rank">${i+1}</td>
            <td>
                <div class="team-cell">
                    <img src="${teamLogos[c[2]]||''}">
                    <span>${c[2]}</span>
                </div>
            </td>
            <td>${c[3]}</td><td>${c[4]}</td><td>${c[5]}</td><td>${c[6]}</td>
            <td>${c[7]}</td><td>${c[8]}</td><td>${c[9]}</td>
            <td>${c[10]}</td><td>${owner}</td>
            <td>${formHTML}</td>
        </tr>`;
    });

    document.getElementById("left-points").innerText=`Points: ${pointsByOwner["Ahmed Ibrahem"]||0}`;
    document.getElementById("right-points").innerText=`Points: ${pointsByOwner["Abdoulrahman Atef"]||0}`;
});

document.querySelector(".rules-toggle").onclick=()=>{
    document.querySelector(".rules-content").classList.toggle("open");
};
</script>

</body>
</html>
