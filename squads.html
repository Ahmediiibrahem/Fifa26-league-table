<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Squads</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="icon" type="image/jpeg" href="fifa26.jpeg">

<style>
body{
  margin:0;
  font-family:'Cairo',Arial,sans-serif;
  color:#fff;
  font-weight:700;
  background:linear-gradient(rgba(15,15,15,.85),rgba(15,15,15,.85)),url("standings-bg.jpg");
  background-size:cover;
  background-attachment:fixed;
}

/* ===== Header / Nav ===== */
.page-header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;}
.header-logo{height:100px}
nav{display:flex;justify-content:center;gap:20px;margin-bottom:20px;flex-wrap:wrap}
nav a{color:#fff;text-decoration:none;background:#2b2b2b;padding:10px 25px;border-radius:8px;font-weight:800}
nav a.active,nav a:hover{background:#3498db}

/* ===== Layout ===== */
.wrap{max-width:1200px;margin:auto;padding:0 10px 30px}
h2{text-align:center;margin:10px 0 14px}

/* ===== Tabs ===== */
.tabs-grid{
  display:grid;
  grid-template-columns:repeat(8,1fr);
  gap:10px;
}
@media(max-width:900px){.tabs-grid{grid-template-columns:repeat(4,1fr)}}

.tab{
  background:#2b2b2b;
  border-radius:12px;
  padding:10px;
  text-align:center;
  cursor:pointer;
  transition:.2s;
  border:1px solid rgba(255,255,255,.1);
}
.tab:hover{background:#3498db}
.tab.active{background:#3498db;box-shadow:0 6px 14px rgba(0,0,0,.4)}

.tab img{
  width:28px;
  height:28px;
  object-fit:contain;
}

/* ===== Dividers ===== */
.divider{height:1px;background:rgba(255,255,255,.15);margin:12px 0}

/* ===== Row Tabs ===== */
.tabs-row{display:flex;justify-content:center;gap:10px;flex-wrap:wrap}

/* ===== Search ===== */
.search-box{
  display:flex;
  align-items:center;
  gap:10px;
  background:rgba(0,0,0,.4);
  border-radius:14px;
  padding:10px 14px;
  max-width:700px;
  margin:auto;
}
.search-box input{
  width:100%;
  background:none;
  border:0;
  outline:0;
  color:#fff;
  font-weight:800;
}

/* ===== Summary ===== */
.summary{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:10px;
  margin:14px 0;
}
@media(max-width:900px){.summary{grid-template-columns:repeat(2,1fr)}}
.card{
  background:rgba(0,0,0,.4);
  border-radius:14px;
  padding:12px;
}
.card .k{font-size:12px;opacity:.8}
.card .v{font-size:18px;font-weight:900}

/* ===== Table ===== */
.table-wrap{overflow:auto;border-radius:12px}
table{width:100%;border-collapse:collapse}
th{background:#2b2b2b;padding:10px}
td{padding:8px;text-align:center}
tr:nth-child(even){background:#1a1a1a}

.player-cell{display:flex;align-items:center;gap:10px;text-align:left}
.player-cell img{width:22px;height:22px;object-fit:contain}
.muted{font-size:12px;opacity:.8}

.pill{
  padding:4px 10px;
  border-radius:999px;
  background:rgba(52,152,219,.25);
  font-size:12px;
  font-weight:800;
}
</style>
</head>

<body>

<div class="page-header">
  <img src="left-logo.png" class="header-logo">
  <img src="right-logo.png" class="header-logo">
</div>

<nav>
  <a href="index.html">Standings</a>
  <a href="matches.html">Results</a>
  <a href="upcoming.html">Upcoming</a>
  <a href="team-stats.html">Stats</a>
  <a href="scorers.html">Scorers</a>
  <a href="squads.html" class="active">Squads</a>
</nav>

<div class="wrap">
<h2>Squads</h2>

<!-- Teams -->
<div id="clubTabs" class="tabs-grid"></div>

<div class="divider"></div>

<!-- Position -->
<div id="posTabs" class="tabs-row"></div>

<div class="divider"></div>

<!-- Sort -->
<div id="sortTabs" class="tabs-row"></div>

<div class="divider"></div>

<!-- Search -->
<div class="search-box">
  üîç <input id="search" placeholder="Search: name, age, shirt, goals, value..." />
</div>

<div class="summary">
  <div class="card"><div class="k">Players</div><div class="v" id="sumPlayers">-</div></div>
  <div class="card"><div class="k">Average Age</div><div class="v" id="sumAvgAge">-</div></div>
  <div class="card"><div class="k">Total Market Value</div><div class="v" id="sumTotalValue">-</div></div>
  <div class="card"><div class="k">Top Value Player</div><div class="v" id="sumMVP">-</div></div>
</div>

<div class="table-wrap">
<table>
<thead>
<tr>
  <th>#</th>
  <th>Player</th>
  <th>Pos</th>
  <th>Age</th>
  <th>Nat</th>
  <th>Foot</th>
  <th>Market</th>
  <th>Goals</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>
</div>

<script>
const squadsURL="https://docs.google.com/spreadsheets/d/e/2PACX-1vT54W8eLRnu7YjOYR49uv-FWsBL1VZR3JUptdsdaP7gYmVIyrtHEmoOd0ZR0uaAijzMXbAhmweN1_5n/pub?gid=609829485&single=true&output=csv";
const scorersURL="https://docs.google.com/spreadsheets/d/e/2PACX-1vT54W8eLRnu7YjOYR49uv-FWsBL1VZR3JUptdsdaP7gYmVIyrtHEmoOd0ZR0uaAijzMXbAhmweN1_5n/pub?gid=940156222&single=true&output=csv";

function parseCSV(t){
  return t.trim().split("\n").map(r=>r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c=>c.replace(/^"|"$/g,"").trim()));
}
const logoSrc=t=>`logos/${encodeURIComponent(t)}.png`;

let all=[],clubs=[],goalsMap={};
let activeClub="ALL",activePos="All",activeSort="shirt";

function makeTab(content,active,cb){
  const d=document.createElement("div");
  d.className="tab"+(active?" active":"");
  if(typeof content==="string") d.textContent=content;
  else d.appendChild(content);
  d.onclick=cb;
  return d;
}

function buildTabs(){
  const ct=document.getElementById("clubTabs");
  ct.innerHTML="";
  ct.appendChild(makeTab("All Teams",activeClub==="ALL",()=>{activeClub="ALL";render();buildTabs()}));
  clubs.forEach(c=>{
    const img=document.createElement("img");
    img.src=logoSrc(c);
    ct.appendChild(makeTab(img,activeClub===c,()=>{activeClub=c;render();buildTabs()}));
  });

  const pt=document.getElementById("posTabs");
  pt.innerHTML="";
  ["All","GK","Def","Mid","Att"].forEach(p=>{
    pt.appendChild(makeTab(p,activePos===p,()=>{activePos=p;render();buildTabs()}));
  });

  const st=document.getElementById("sortTabs");
  st.innerHTML="";
  [["shirt","#"],["age","Age"],["value","Value"],["name","Name"]].forEach(s=>{
    st.appendChild(makeTab(s[1],activeSort===s[0],()=>{activeSort=s[0];render();buildTabs()}));
  });
}

function render(){
  let rows=[...all];
  const q=document.getElementById("search").value.toLowerCase();

  if(activeClub!=="ALL") rows=rows.filter(r=>r.club===activeClub);
  if(activePos!=="All") rows=rows.filter(r=>r.posSC===activePos);

  if(q){
    rows=rows.filter(r=>
      `${r.player} ${r.club} ${r.age} ${r.shirt} ${r.value} ${r.goals}`.toLowerCase().includes(q)
    );
  }

  rows.sort((a,b)=>{
    if(activeSort==="shirt") return a.shirt-b.shirt;
    if(activeSort==="age") return (a.age??99)-(b.age??99);
    if(activeSort==="value") return b.value-a.value;
    if(activeSort==="name") return a.player.localeCompare(b.player);
  });

  document.getElementById("sumPlayers").textContent=rows.length;
  document.getElementById("sumAvgAge").textContent=rows.length?Math.round(rows.reduce((s,r)=>s+(r.age||0),0)/rows.length):"-";
  document.getElementById("sumTotalValue").textContent=rows.reduce((s,r)=>s+r.value,0)+" M";
  document.getElementById("sumMVP").textContent=rows.sort((a,b)=>b.value-a.value)[0]?.player||"-";

  const tb=document.getElementById("tbody");
  tb.innerHTML="";
  rows.forEach(r=>{
    tb.innerHTML+=`
      <tr>
        <td>${r.shirt}</td>
        <td class="player-cell"><img src="${logoSrc(r.club)}"><div><b>${r.player}</b><div class="muted">${r.club}</div></div></td>
        <td>${r.pos}</td>
        <td>${r.age||"-"}</td>
        <td>${r.nat}</td>
        <td>${r.foot?`<span class="pill">${r.foot}</span>`:""}</td>
        <td>${r.value}</td>
        <td>${r.goals}</td>
      </tr>`;
  });
}

Promise.all([
  fetch(squadsURL).then(r=>r.text()),
  fetch(scorersURL).then(r=>r.text())
]).then(([sCSV,gCSV])=>{
  const g=parseCSV(gCSV).slice(1);
  g.forEach(r=>{
    const k=(r[2]+"||"+r[3]).toLowerCase();
    goalsMap[k]=(goalsMap[k]||0)+1;
  });

  const rows=parseCSV(sCSV).slice(1);
  all=rows.map(r=>{
    const club=r[0],player=r[2];
    return{
      club,
      shirt:+r[1]||0,
      player,
      pos:r[3],
      age:+r[5]||null,
      nat:r[6],
      foot:r[8],
      value:+r[12]||0,
      posSC:r[13],
      goals:goalsMap[(club+"||"+player).toLowerCase()]||0
    };
  });

  clubs=[...new Set(all.map(r=>r.club))];
  buildTabs();
  render();
});

document.getElementById("search").addEventListener("input",render);
</script>

</body>
</html>
