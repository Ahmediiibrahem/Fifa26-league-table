<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Matches</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
<link rel="icon" type="image/jpeg" href="fifa26.jpeg">

<style>
  body{
    margin:0;
    font-family:'Cairo', Arial, sans-serif;
    color:#fff;
    font-weight:700;
    background:linear-gradient(rgba(15,15,15,.85),rgba(15,15,15,.85)), url("standings-bg.jpg");
    background-size:cover;
    background-position:center;
    background-attachment:fixed;
  }

  .page-header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;}
  .header-logo{height:100px;object-fit:contain;}

  nav{
    display:flex;justify-content:center;gap:20px;margin-bottom:18px;
    flex-wrap:wrap;padding:0 10px;
  }
  nav a{
    text-decoration:none;color:#fff;font-weight:800;padding:10px 25px;border-radius:8px;
    transition:all .25s;background:#2b2b2b;
  }
  nav a:hover{background:#3498db;transform:scale(1.05);}
  nav a.active{background:#3498db;box-shadow:0 4px 8px rgba(0,0,0,.3);}

  .wrap{max-width:1100px;margin:0 auto;padding:0 10px 30px;}
  h2{text-align:center;margin:10px 0 14px;font-weight:900;}

  /* Top tabs */
  .top-tabs{
    display:flex;
    justify-content:center;
    gap:10px;
    flex-wrap:wrap;
    margin:10px 0 14px;
  }
  .tab{
    background:#2b2b2b;
    border:1px solid rgba(255,255,255,.10);
    color:#fff;
    border-radius:12px;
    padding:10px 18px;
    font-weight:900;
    cursor:pointer;
    transition:.2s;
    user-select:none;
  }
  .tab:hover{background:#3498db;}
  .tab.active{
    background:#3498db;
    box-shadow:0 6px 16px rgba(0,0,0,.35);
    border-color:rgba(52,152,219,.6);
  }

  .panel{display:none;}
  .panel.active{display:block;}

  table{width:100%;border-collapse:collapse;font-size:14px;margin-top:10px;}
  th{background:#2b2b2b;padding:10px;font-weight:900;white-space:nowrap;}
  td{padding:8px;text-align:center;white-space:nowrap;}
  tr:nth-child(even){background:#1a1a1a;}

  .round-separator{background: linear-gradient(to right, #3498db, #2980b9); height:5px;}
  .muted{opacity:.85;font-size:12px;font-weight:700;text-align:center;margin-top:10px;}
  .table-wrap{width:100%;overflow:auto;border-radius:12px;}

  /* Optional: small count cards */
  .counts{
    display:flex;
    justify-content:center;
    gap:10px;
    flex-wrap:wrap;
    margin:10px 0 4px;
  }
  .count-card{
    background:rgba(0,0,0,.35);
    border:1px solid rgba(255,255,255,.10);
    border-radius:14px;
    padding:10px 14px;
    min-width:180px;
    text-align:center;
  }
  .count-card .k{font-size:12px;opacity:.85;font-weight:700;}
  .count-card .v{font-size:18px;font-weight:900;margin-top:4px;}
</style>
</head>

<body>

<div class="page-header">
  <img src="left-logo.png" alt="Left Logo" class="header-logo left">
  <img src="right-logo.png" alt="Right Logo" class="header-logo right">
</div>

<!-- ✅ Nav بعد حذف Stats -->
<nav>
  <a href="index.html">Standings</a>
  <a href="matches.html" class="active">Matches</a>
  <a href="scorers.html">Scorers</a>
  <a href="squads.html">Squads</a>
</nav>

<div class="wrap">
  <h2>Matches</h2>

  <div class="top-tabs">
    <div class="tab active" id="tabResults">Results</div>
    <div class="tab" id="tabUpcoming">Upcoming</div>
  </div>

  <div class="counts">
    <div class="count-card">
      <div class="k">Played</div>
      <div class="v" id="playedCount">0</div>
    </div>
    <div class="count-card">
      <div class="k">Upcoming</div>
      <div class="v" id="upcomingCount">0</div>
    </div>
  </div>

  <!-- Results Panel -->
  <div class="panel active" id="panelResults">
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Home Team</th>
            <th>Home</th>
            <th>Away</th>
            <th>Away Team</th>
          </tr>
        </thead>
        <tbody id="resultsBody"></tbody>
      </table>
    </div>
    <div class="muted">Showing matches with status: <b>Played</b></div>
  </div>

  <!-- Upcoming Panel -->
  <div class="panel" id="panelUpcoming">
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Home Team</th>
            <th>Away Team</th>
          </tr>
        </thead>
        <tbody id="upcomingBody"></tbody>
      </table>
    </div>
    <div class="muted">Showing matches with status: <b>Upcoming</b></div>
  </div>
</div>

<script>
const matchesSheetURL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vT54W8eLRnu7YjOYR49uv-FWsBL1VZR3JUptdsdaP7gYmVIyrtHEmoOd0ZR0uaAijzMXbAhmweN1_5n/pub?gid=866991516&single=true&output=csv";

function parseCSV(text){
  return text.trim().split("\n").map(row =>
    row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(col => col.replace(/^"|"$/g, "").trim())
  );
}

/* Tabs logic */
const tabResults  = document.getElementById("tabResults");
const tabUpcoming = document.getElementById("tabUpcoming");
const panelResults  = document.getElementById("panelResults");
const panelUpcoming = document.getElementById("panelUpcoming");

function showPanel(which){
  const isResults = which === "results";

  tabResults.classList.toggle("active", isResults);
  tabUpcoming.classList.toggle("active", !isResults);

  panelResults.classList.toggle("active", isResults);
  panelUpcoming.classList.toggle("active", !isResults);

  // optional: update hash
  location.hash = isResults ? "#results" : "#upcoming";
}

tabResults.addEventListener("click", ()=> showPanel("results"));
tabUpcoming.addEventListener("click", ()=> showPanel("upcoming"));

// open by hash
if(location.hash.toLowerCase() === "#upcoming") showPanel("upcoming");

/* Render */
fetch(matchesSheetURL + "&t=" + Date.now(), { cache:"no-store" })
  .then(res => res.text())
  .then(csv => {
    const all = parseCSV(csv).slice(1);

    const resultsBody = document.getElementById("resultsBody");
    const upcomingBody = document.getElementById("upcomingBody");
    resultsBody.innerHTML = "";
    upcomingBody.innerHTML = "";

    let playedCount = 0;
    let upcomingCount = 0;

    // Results: keep the same “round separator every 8 played matches” behavior
    let playedPrinted = 0;

    all.forEach(row => {
      // columns used in your old code
      const matchID   = row[1];
      const homeTeam  = row[2];
      const homeScore = row[6];
      const awayScore = row[7];
      const awayTeam  = row[11];
      const status    = (row[15] || "").trim(); // Played / Upcoming

      if(!matchID || !homeTeam || !awayTeam || !status) return;

      if(status === "Played"){
        // validate scores
        if(isNaN(parseInt(homeScore)) || isNaN(parseInt(awayScore))) return;

        resultsBody.innerHTML += `
          <tr>
            <td>${matchID}</td>
            <td>${homeTeam}</td>
            <td>${homeScore}</td>
            <td>${awayScore}</td>
            <td>${awayTeam}</td>
          </tr>
        `;

        playedCount++;
        playedPrinted++;

        if(playedPrinted % 8 === 0){
          resultsBody.innerHTML += `<tr class="round-separator"><td colspan="5"></td></tr>`;
        }
      }

      if(status === "Upcoming"){
        upcomingBody.innerHTML += `
          <tr>
            <td>${matchID}</td>
            <td>${homeTeam}</td>
            <td>${awayTeam}</td>
          </tr>
        `;
        upcomingCount++;
      }
    });

    document.getElementById("playedCount").textContent = playedCount;
    document.getElementById("upcomingCount").textContent = upcomingCount;
  })
  .catch(err => console.error("Error loading matches sheet:", err));
</script>

</body>
</html>
